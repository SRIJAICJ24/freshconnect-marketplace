{% extends 'base.html' %}

{% block content %}
<style>
    .driver-header {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
        color: white;
        padding: 2.5rem;
        border-radius: 20px;
        margin-bottom: 2rem;
        box-shadow: 0 20px 60px rgba(30, 60, 114, 0.4);
        position: relative;
        overflow: hidden;
    }
    
    .driver-header::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -10%;
        width: 400px;
        height: 400px;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        border-radius: 50%;
    }
    
    .stat-card {
        border-radius: 20px;
        border: none;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
        position: relative;
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
        opacity: 0;
        transition: opacity 0.4s;
    }
    
    .stat-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 20px 50px rgba(0,0,0,0.2);
    }
    
    .stat-card:hover::before {
        opacity: 1;
    }
    
    .stat-icon {
        font-size: 2.5rem;
        opacity: 0.8;
    }
    
    .action-btn {
        border-radius: 12px;
        padding: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        border: none;
    }
    
    .action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    
    .info-card {
        border-radius: 15px;
        border: none;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    }
    
    .vehicle-icon {
        font-size: 5rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        opacity: 0.2;
        position: absolute;
        right: 20px;
        bottom: 10px;
        animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
    }
    
    .vehicle-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 30px;
        font-weight: 600;
        font-size: 0.9rem;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    
    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    .progress-bar-animated {
        animation: progress-animation 1s ease-in-out;
    }
    
    @keyframes progress-animation {
        from { width: 0; }
    }
</style>

<div class="container py-4">
    <!-- Welcome Header -->
    <div class="driver-header">
        <div class="row align-items-center position-relative" style="z-index: 1;">
            <div class="col-md-8">
                <div class="mb-3">
                    <span class="vehicle-badge">
                        {% if driver.vehicle_type == 'bike' %}
                        <i class="fas fa-motorcycle"></i>
                        {% elif driver.vehicle_type == 'tempo' %}
                        <i class="fas fa-truck"></i>
                        {% elif driver.vehicle_type == 'truck' %}
                        <i class="fas fa-truck-moving"></i>
                        {% elif driver.vehicle_type == 'mini_truck' %}
                        <i class="fas fa-truck-pickup"></i>
                        {% else %}
                        <i class="fas fa-car"></i>
                        {% endif %}
                        {{ driver.vehicle_type.replace('_', ' ').title() }} Driver
                    </span>
                </div>
                <h1 class="mb-2 fw-bold">
                    Welcome, {{ current_user.name }}! ðŸ‘‹
                </h1>
                <p class="mb-2 opacity-90">
                    <i class="fas fa-id-badge me-2"></i>{{ driver.vehicle_registration }}
                    <span class="mx-2">â€¢</span>
                    <i class="fas fa-calendar-day me-2"></i>{{ current_user.created_at.strftime('%B %d, %Y') }}
                </p>
                <p class="mb-0 opacity-75">
                    <i class="fas fa-shipping-fast me-2"></i>{{ driver.total_deliveries or 0 }} Deliveries Completed
                </p>
            </div>
            <div class="col-md-4 text-end">
                <div class="status-badge bg-{{ 'success' if driver.status == 'available' else 'warning' }} text-white mb-3">
                    <i class="fas fa-circle pulse"></i> {{ driver.status.upper() }}
                </div>
                <div class="text-white opacity-90">
                    <div class="mb-1">
                        <i class="fas fa-star text-warning"></i>
                        <strong class="ms-1">{{ driver.rating or 5.0 }}</strong>
                        <small class="opacity-75">/5.0 Rating</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row g-4 mb-4">
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Pending Deliveries</h6>
                            <h2 class="mb-0 fw-bold">{{ pending }}</h2>
                            <small class="text-white-75">Waiting for pickup</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Active Deliveries</h6>
                            <h2 class="mb-0 fw-bold">{{ active }}</h2>
                            <small class="text-white-75">Currently in transit</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Completed</h6>
                            <h2 class="mb-0 fw-bold">{{ driver.total_deliveries or 0 }}</h2>
                            <small class="text-white-75">Total deliveries</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Vehicle and Earnings Info -->
    <div class="row g-4 mb-4">
        <div class="col-md-6">
            <div class="card info-card">
                <div class="card-header bg-white border-0">
                    <h5 class="mb-0">
                        {% if driver.vehicle_type == 'bike' %}
                        <i class="fas fa-motorcycle text-danger"></i>
                        {% elif driver.vehicle_type == 'tempo' %}
                        <i class="fas fa-truck text-info"></i>
                        {% elif driver.vehicle_type == 'truck' %}
                        <i class="fas fa-truck-moving text-primary"></i>
                        {% elif driver.vehicle_type == 'mini_truck' %}
                        <i class="fas fa-truck-pickup text-warning"></i>
                        {% else %}
                        <i class="fas fa-car text-success"></i>
                        {% endif %}
                        Vehicle Information
                    </h5>
                </div>
                <div class="card-body position-relative">
                    {% if driver.vehicle_type == 'bike' %}
                    <i class="fas fa-motorcycle vehicle-icon"></i>
                    {% elif driver.vehicle_type == 'tempo' %}
                    <i class="fas fa-truck vehicle-icon"></i>
                    {% elif driver.vehicle_type == 'truck' %}
                    <i class="fas fa-truck-moving vehicle-icon"></i>
                    {% elif driver.vehicle_type == 'mini_truck' %}
                    <i class="fas fa-truck-pickup vehicle-icon"></i>
                    {% else %}
                    <i class="fas fa-car vehicle-icon"></i>
                    {% endif %}
                    
                    <div class="row g-3">
                        <div class="col-12">
                            <div class="p-3 bg-light rounded">
                                <div class="d-flex align-items-center mb-2">
                                    <i class="fas fa-truck-loading text-primary me-2"></i>
                                    <strong>{{ driver.vehicle_type.replace('_', ' ').title() }}</strong>
                                </div>
                                <small class="text-muted">Registration: <strong>{{ driver.vehicle_registration }}</strong></small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="text-center p-2 bg-light rounded">
                                <i class="fas fa-weight-hanging text-success mb-1"></i>
                                <div><small class="text-muted d-block">Max Capacity</small></div>
                                <strong class="text-success">{{ driver.vehicle_capacity_kg or 50 }} kg</strong>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="text-center p-2 bg-light rounded">
                                <i class="fas fa-boxes text-warning mb-1"></i>
                                <div><small class="text-muted d-block">Current Load</small></div>
                                <strong class="text-warning">{{ driver.current_load_kg or 0 }} kg</strong>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <small class="text-muted fw-bold">Load Capacity</small>
                            <small class="badge bg-primary">{{ ((driver.current_load_kg or 0) / (driver.vehicle_capacity_kg or 50) * 100)|round(1) }}%</small>
                        </div>
                        <div class="progress" style="height: 12px; border-radius: 10px; background-color: #e9ecef;">
                            {% set load_percent = ((driver.current_load_kg or 0) / (driver.vehicle_capacity_kg or 50) * 100) %}
                            <div class="progress-bar progress-bar-striped progress-bar-animated 
                                        {% if load_percent < 50 %}bg-success{% elif load_percent < 80 %}bg-warning{% else %}bg-danger{% endif %}" 
                                 role="progressbar" style="width: {{ load_percent }}%">
                            </div>
                        </div>
                        <small class="text-muted mt-1 d-block">
                            <i class="fas fa-info-circle"></i> 
                            Available: {{ (driver.vehicle_capacity_kg or 50) - (driver.current_load_kg or 0) }} kg
                        </small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card info-card">
                <div class="card-header bg-white border-0">
                    <h5 class="mb-0">
                        <i class="fas fa-wallet text-success"></i> Earnings Overview
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <h1 class="display-4 fw-bold text-success mb-0">
                            â‚¹{{ (driver.total_deliveries or 0) * 150 }}
                        </h1>
                        <p class="text-muted mb-0">Total Earnings</p>
                    </div>
                    
                    <div class="row text-center g-3">
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Per Delivery</small>
                                <strong class="text-success">â‚¹150</strong>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Rating</small>
                                <strong class="text-warning">
                                    {{ driver.rating or 5.0 }} <i class="fas fa-star"></i>
                                </strong>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Trips</small>
                                <strong>{{ driver.total_deliveries or 0 }}</strong>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-3 mb-0 small">
                        <i class="fas fa-info-circle"></i> Earnings calculated at â‚¹150 per delivery
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="card info-card mb-4">
        <div class="card-header bg-white border-0">
            <h5 class="mb-0">
                <i class="fas fa-bolt text-warning"></i> Quick Actions
            </h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4 col-sm-6">
                    <a href="/driver/assignments" class="btn action-btn btn-primary w-100 d-flex align-items-center justify-content-center">
                        <i class="fas fa-list-ul me-2"></i> View Assignments
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="{{ url_for('driver.routes') }}" class="btn action-btn btn-success w-100 d-flex align-items-center justify-content-center">
                        <i class="fas fa-route me-2"></i> My Routes
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="{{ url_for('driver.deliveries') }}" class="btn action-btn btn-info w-100 d-flex align-items-center justify-content-center text-white">
                        <i class="fas fa-truck-loading me-2"></i> My Deliveries
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Features Info -->
    <div class="card info-card">
        <div class="card-header bg-gradient-primary text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h5 class="mb-0">
                <i class="fas fa-star"></i> Available Features
            </h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-map-marked-alt fa-2x text-primary"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">GPS Routes</h6>
                            <small class="text-muted">View planned routes with coordinates</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-tasks fa-2x text-success"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">4-Step Tracking</h6>
                            <small class="text-muted">Amazon-style delivery tracking</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-calculator fa-2x text-warning"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">Logistics Pricing</h6>
                            <small class="text-muted">Distance, weight & detour costs</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
