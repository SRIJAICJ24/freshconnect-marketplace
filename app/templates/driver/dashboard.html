{% extends 'base.html' %}

{% block content %}
<style>
    .driver-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 15px;
        margin-bottom: 2rem;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }
    
    .stat-card {
        border-radius: 15px;
        border: none;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        overflow: hidden;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(0,0,0,0.15);
    }
    
    .stat-icon {
        font-size: 2.5rem;
        opacity: 0.8;
    }
    
    .action-btn {
        border-radius: 12px;
        padding: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        border: none;
    }
    
    .action-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    
    .info-card {
        border-radius: 15px;
        border: none;
        box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    }
    
    .vehicle-icon {
        font-size: 4rem;
        color: #667eea;
        opacity: 0.15;
        position: absolute;
        right: 20px;
        bottom: 10px;
    }
    
    .status-badge {
        padding: 0.5rem 1rem;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
    }
    
    .progress-bar-animated {
        animation: progress-animation 1s ease-in-out;
    }
    
    @keyframes progress-animation {
        from { width: 0; }
    }
</style>

<div class="container py-4">
    <!-- Welcome Header -->
    <div class="driver-header">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h2 class="mb-2">
                    <i class="fas fa-truck-moving"></i> Welcome, {{ current_user.name }}!
                </h2>
                <p class="mb-0 opacity-75">
                    <i class="fas fa-calendar-day"></i> {{ current_user.created_at.strftime('%B %d, %Y') }}
                </p>
            </div>
            <div class="col-md-4 text-end">
                <div class="status-badge bg-{{ 'success' if driver.status == 'available' else 'warning' }} text-white">
                    <i class="fas fa-circle"></i> {{ driver.status.upper() }}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Statistics Cards -->
    <div class="row g-4 mb-4">
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Pending Deliveries</h6>
                            <h2 class="mb-0 fw-bold">{{ pending }}</h2>
                            <small class="text-white-75">Waiting for pickup</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Active Deliveries</h6>
                            <h2 class="mb-0 fw-bold">{{ active }}</h2>
                            <small class="text-white-75">Currently in transit</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-shipping-fast"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-4 col-sm-6">
            <div class="card stat-card bg-gradient" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <div class="card-body text-white">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="text-white-50 mb-2">Completed</h6>
                            <h2 class="mb-0 fw-bold">{{ driver.total_deliveries or 0 }}</h2>
                            <small class="text-white-75">Total deliveries</small>
                        </div>
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Vehicle and Earnings Info -->
    <div class="row g-4 mb-4">
        <div class="col-md-6">
            <div class="card info-card">
                <div class="card-header bg-white border-0">
                    <h5 class="mb-0">
                        <i class="fas fa-car text-primary"></i> Vehicle Information
                    </h5>
                </div>
                <div class="card-body position-relative">
                    <i class="fas fa-truck vehicle-icon"></i>
                    
                    <div class="row g-3">
                        <div class="col-6">
                            <small class="text-muted d-block">Type</small>
                            <strong>{{ driver.vehicle_type.title() }}</strong>
                        </div>
                        <div class="col-6">
                            <small class="text-muted d-block">Registration</small>
                            <strong>{{ driver.vehicle_registration }}</strong>
                        </div>
                        <div class="col-6">
                            <small class="text-muted d-block">Capacity</small>
                            <strong>{{ driver.vehicle_capacity_kg or 50 }} kg</strong>
                        </div>
                        <div class="col-6">
                            <small class="text-muted d-block">Current Load</small>
                            <strong>{{ driver.current_load_kg or 0 }} kg</strong>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <small class="text-muted d-block mb-2">Load Capacity</small>
                        <div class="progress" style="height: 8px; border-radius: 10px;">
                            <div class="progress-bar bg-success progress-bar-animated" role="progressbar" 
                                 style="width: {{ ((driver.current_load_kg or 0) / (driver.vehicle_capacity_kg or 50) * 100) }}%">
                            </div>
                        </div>
                        <small class="text-muted">{{ ((driver.current_load_kg or 0) / (driver.vehicle_capacity_kg or 50) * 100)|round(1) }}% loaded</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card info-card">
                <div class="card-header bg-white border-0">
                    <h5 class="mb-0">
                        <i class="fas fa-wallet text-success"></i> Earnings Overview
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <h1 class="display-4 fw-bold text-success mb-0">
                            ₹{{ (driver.total_deliveries or 0) * 150 }}
                        </h1>
                        <p class="text-muted mb-0">Total Earnings</p>
                    </div>
                    
                    <div class="row text-center g-3">
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Per Delivery</small>
                                <strong class="text-success">₹150</strong>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Rating</small>
                                <strong class="text-warning">
                                    {{ driver.rating or 5.0 }} <i class="fas fa-star"></i>
                                </strong>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="p-2 bg-light rounded">
                                <small class="text-muted d-block">Trips</small>
                                <strong>{{ driver.total_deliveries or 0 }}</strong>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-3 mb-0 small">
                        <i class="fas fa-info-circle"></i> Earnings calculated at ₹150 per delivery
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="card info-card mb-4">
        <div class="card-header bg-white border-0">
            <h5 class="mb-0">
                <i class="fas fa-bolt text-warning"></i> Quick Actions
            </h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4 col-sm-6">
                    <a href="/driver/assignments" class="btn action-btn btn-primary w-100 d-flex align-items-center justify-content-center">
                        <i class="fas fa-list-ul me-2"></i> View Assignments
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="{{ url_for('driver.routes') }}" class="btn action-btn btn-success w-100 d-flex align-items-center justify-content-center">
                        <i class="fas fa-route me-2"></i> My Routes
                    </a>
                </div>
                <div class="col-md-4 col-sm-6">
                    <a href="{{ url_for('driver.deliveries') }}" class="btn action-btn btn-info w-100 d-flex align-items-center justify-content-center text-white">
                        <i class="fas fa-truck-loading me-2"></i> My Deliveries
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Features Info -->
    <div class="card info-card">
        <div class="card-header bg-gradient-primary text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h5 class="mb-0">
                <i class="fas fa-star"></i> Available Features
            </h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-map-marked-alt fa-2x text-primary"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">GPS Routes</h6>
                            <small class="text-muted">View planned routes with coordinates</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-tasks fa-2x text-success"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">4-Step Tracking</h6>
                            <small class="text-muted">Amazon-style delivery tracking</small>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="d-flex align-items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-calculator fa-2x text-warning"></i>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">Logistics Pricing</h6>
                            <small class="text-muted">Distance, weight & detour costs</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
